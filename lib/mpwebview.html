<html>

<head>
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <style>
        .button {
            display: inline-block;
            border: solid black 1px;
            background-color: rgb(222, 222, 232);
            color: #134A1E;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            outline: none;
            line-height: 30px;
            padding: 1px 5px;
            margin-block-start: 10px;
            margin-inline-start: 5px;
            transition: all .2s ease-in-out;
        }

        .button:hover {
            background-color: rgb(202, 202, 209)
        }

        .button:active {
            background-color: rgb(202, 202, 209);
            transform: scale(0.9);
        }

        .button-group {
            overflow: scroll;
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 70%;
        }

        #console-panel {
            margin-block-start: 20px;
            border: solid black 1px;
            position: absolute;
            left: 5px;
            bottom: 0;
            right: 5px;
            height: 29%;
            padding: 0 5px;
            background-color: rgb(245, 245, 245);
            display:flex;
            flex-direction: column;
            align-items: flex-start;
        }

        #console-panel #console {
            width: 100%;
            height: 100%;
            overflow: scroll;
        }
    
        #console-panel button {
            align-self: stretch;
            padding: 10px;
        }
    </style>
</head>
    <script src="https://cdn.bootcdn.net/ajax/libs/dsbridge/3.1.4/dsbridge.min.js"></script>
<script>

    function testGetUserInfo() {
        var info = dsBridge.call("getUserInfo")
        log("get userinfo: " + JSON.stringify(info) + "<br/>")
    }
    
    function testGetAppInfo() {
        var info = dsBridge.call("getAppInfo")
        log("getAppInfo: " + JSON.stringify(info) + "<br/>")
    }
    
    function testGetOSInfo() {
        var info = dsBridge.call("getOSInfo")
        log("getOSInfo: " + JSON.stringify(info) + "<br/>")
    }
    
    
    
    function testGetLocation() {
        dsBridge.call("getLocation", function (location) {
            log("get location: " + JSON.stringify(location) + "<br/>")
        })
    }

    function testShare() {
        dsBridge.call("share", { image: "xxxx" }, function (result) {
            log("share complete: " + JSON.stringify(result) + "<br/>")
        })
    }

    function testRegisterLocationEvent() {
        dsBridge.register("LOCATION", function (location) {
            log("new location: " + JSON.stringify(location) + "<br/>")
        })
    }

    function testRegisterNegworkEvent() {
        dsBridge.register("ON_NET_WORK_CHANGE", function (event) {
            log("network change: " + JSON.stringify(event) + "<br/>")
        })
    }

    function testShowToast() {
        dsBridge.call("showToast", "hello world")
    }

    function testLog() {
        dsBridge.call("logger", { type: "debug", message: "some message" })
        dsBridge.call("logger", { type: "error", message: "some message" })
    }

    function testOpenSetting() {
        dsBridge.call("openAppSetting")
    }

    function testMakePhoneCall() {
        dsBridge.call("makePhoneCall", '13167101067')
    }

    function testSetValue() {
        dsBridge.call("setValue", { key: 'testkey', value: { "key1": "value1", "key2": "value2" } })
        dsBridge.call("setValue", { key: 'testkey2', value: ["test1", "test2", "test3"] })
    }

    function testGetValue() {
        log(dsBridge.call("getValue", "testkey") + "<br/>")
        log(dsBridge.call("getValue", "testkey2") + "<br/>")
    }

    function testRemoveValue() {
        log(dsBridge.call("remove", "testkey") + "<br/>")
    }

    function testClearValue() {
        log(dsBridge.call("clear") + "<br/>")
    }

    function testSetClipboard() {
        dsBridge.call("setCopyText", "Clipboard content", function (result) {
            log("set clipboard complete: " + result + "<br/>")
        })
    }

    function testGetClipboard() {
        log(dsBridge.call("getCopyText") + "<br/>")
    }

    function clearConsole() {
        let ele = document.getElementById('console');
        ele.innerHTML = "";
    }
    
    function testShowLogin() {
        dsBridge.call("openURL", "nio://user/requirelogin", function (result) {
            log("login" + JSON.stringify(result) + "<br/>")
        })
    }
    
    function testOpenPUGC() {
        dsBridge.call("openURL", "https://app-test.nio.com/app/web/v2/page/community?from_conversation=false&community_id=de1c8731-9fbf-4e&load_js_bridge=true&show_navigator=false", function (result) {
            log("login" + JSON.stringify(result) + "<br/>")
        })
    }

    function imagePicker() {
        dsBridge.call("imagePicker", function (result) {
            log("update" + JSON.stringify(result) + "<br/>")
        })
    }

    function openMap() {
        dsBridge.call("openMap",{latitude: 31.278812, longitude: 121.196305, addressName: "上海moudi"}, function (result) {
            log("openmap" + JSON.stringify(result) + "<br/>")
        })
    }

    function pickCountries() {
        dsBridge.call("openURL", "nio://user/countries?callingCode=47", function (result) {
            log("countries" + JSON.stringify(result) + "<br/>")
        })
    }

    function pickAddress() {
        dsBridge.call("openURL", "nio://user/address/list", function (result) {
            log("countries" + JSON.stringify(result) + "<br/>")
        })
    }

    function pickVehicle() {
        dsBridge.call("openURL", "nio://vehicle/switch", function (result) {
            log("vehicle/switch" + JSON.stringify(result) + "<br/>")
        })
    }
    
    function createNote() {
        dsBridge.call("openURL", "nio://post/note/publish", function (result) {
            log("post/note/publish" + JSON.stringify(result) + "<br/>")
        })
    }

    
    function openNewDemoPage() {
        dsBridge.call("openURL", location.href, function (result) {
            
        })
    }
    function setLocalStorage() {
        var today = new Date()
        localStorage.setItem('testkey', 'hello ' + today.toString());
    }

    function getLocalStorage() {
        log(localStorage.getItem('testkey') + "<br/>")
    }

    function turnOnBounch() {
        dsBridge.call("tootleBounch", true)
    }

    function turnOffBounch() {
        dsBridge.call("tootleBounch", false)
    }
    
    function getCurrencyFormat() {
        var arg = {
                      "currency_code": "NOK",
                      "price":123456.889,
                      "minimumFractionDigits":2,
                      "maximumFractionDigits":2,
                      "local":"nb_NO"
                    }
        var result = dsBridge.call("getCurrencyFormat", arg)
        log( JSON.stringify(result) + "<br/>")
    }
    
    function getNumberFormat() {
        var arg = {
                      "number":123456.889,
                      "minimumFractionDigits":0,
                      "maximumFractionDigits":0,
                      "local":"zh_CN"
                    }
        var result = dsBridge.call("getNumberFormat", arg)
        log( JSON.stringify(result) + "<br/>")
    }

    function popMenu() {
        dsBridge.call("popMenu", {options: ["Copy", "Report"]}, function(result){
            log("popMenu" + JSON.stringify(result) + "<br/>")
        })
    }
    
    function confirm() {
        var arg =  {
            "title": "title",
            "content": "some contents",
            "buttons": [
                 { "title": "cancel", "type": "cancel" } ,
                 {  "title": "OK", "type": "yes" }
            ]
        }

        dsBridge.call("confirm", arg, function(result){
            log("confirm" + JSON.stringify(result) + "<br/>")
        })
    }
    
    function getVehicleInfo() {
        dsBridge.call("getVehicleInfo", function(result){
            log("getVehicleInfo" + JSON.stringify(result) + "<br/>")
        })
    }

    function log(message) {
        let ele = document.getElementById('console');
        ele.innerHTML += message;
    }

</script>

<body>
    <div class="button-group">
        <a class="button" onclick="testGetUserInfo()">Get UserInfo</a>
        
        <a class="button" onclick="testGetAppInfo()">testGetAppInfo</a>
        
        <a class="button" onclick="testGetOSInfo()">testGetOSInfo</a>
        
        <a class="button" onclick="openNewDemoPage()">openNewDemoPage</a>
        
        <a class="button" onclick="testOpenPUGC()">testOpenPUGC</a>
        
        <a class="button" onclick="createNote()">createNote</a>

        <a class="button" onclick="testGetLocation()">Get Location</a>

        <a class="button" onclick="testShare()">Share</a>

        <a class="button" onclick="testRegisterLocationEvent()">Register Location Event</a>

        <a class="button" onclick="testShowToast()">Show Toast</a>

        <a class="button" onclick="testLog()">test log</a>

        <a class="button" onclick="testOpenSetting()">open app setting</a>

        <a class="button" onclick="testMakePhoneCall()">make phone call</a>

        <a class="button" onclick="testRegisterNegworkEvent()">register natwork status event</a>

        <a class="button" onclick="testSetValue()">setValue</a>

        <a class="button" onclick="testGetValue()">getValue</a>

        <a class="button" onclick="testRemoveValue()">removeValue</a>

        <a class="button" onclick="testClearValue()">clearValue</a>

        <a class="button" onclick="testSetClipboard()">setClipboard</a>

        <a class="button" onclick="testGetClipboard()">getClipboard</a>
        
        <a class="button" onclick="testShowLogin()">showLogin</a>
        
        <a class="button" onclick="imagePicker()">imagePicker</a>
        
        <a class="button" onclick="openMap()">openMap</a>
        
        <a class="button" onclick="pickCountries()">pickCountries</a>
        
        <a class="button" onclick="pickAddress()">pickAddress</a>
        
        <a class="button" onclick="pickVehicle()">pickVehicle</a>
        
        <a class="button" onclick="setLocalStorage()">setLocalStorage</a>
        
        <a class="button" onclick="getLocalStorage()">getLocalStorage</a>
        
        <a class="button" onclick="turnOnBounch()">turnOnBounch</a>
        
        <a class="button" onclick="turnOffBounch()">turnOffBounch</a>
        
        <a class="button" onclick="popMenu()">popMenu</a>
        
        <a class="button" onclick="getVehicleInfo()">getVehicleInfo</a>
        
        <a class="button" onclick="getCurrencyFormat()">getCurrencyFormat</a>

        <a class="button" onclick="getNumberFormat()">getNumberFormat</a>
        
        <a class="button" onclick="confirm()">confirm</a>
        
        <a class="button" href="mailto: yunchou.peng@nio.com">Mail me</a>
        
    </div>

    <div id='console-panel'>
        <button onclick="clearConsole()">Clear</button>
        <div id="console"></div>
    </div>
</body>

</html>
